# ğŸ§¬ QIIME2æœ¬è§£æãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼ˆver. 2024.05å¯¾å¿œãƒ»å…±é€šãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰

æœ¬ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¯ã€16S rRNAè§£æã®å…±é€šæ‰‹é †ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

è§£æã®ä¸€é€£ã®æµã‚Œï¼ˆFASTQ â†’ QIIME2 â†’ PICRUSt2 â†’ å¯è¦–åŒ–ï¼‰ã‚’é€šã—ã¦ã€
å†ç¾æ€§ãƒ»å…±æœ‰æ€§ãƒ»åŠ¹ç‡æ€§ã‚’ç¢ºä¿ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã§ã¯ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³â§‰ãŒç™»å ´ã—

â§‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§ãã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã—ã‹ã—ã€ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«è¼‰ã›ã‚‹éƒ½åˆä¸Šã€ã‚³ãƒ”ãƒšãŒå¿…è¦ã®ãªã„ç®‡æ‰€ã«ã‚‚â§‰ãŒç™»å ´ã™ã‚‹ãŸã‚

**ã‚³ãƒ”ãƒšãŒå¿…è¦ãªç®‡æ‰€ã«ã¯ã€ŒğŸ“‹ã€ã‚’è¼‰ã›ã¦ãŠã**ã®ã§ã€å„è‡ªåˆ¤æ–­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚

---
## ğŸ–¥ï¸ STEP 1ã€€ï½œã€€è§£æã‚’å§‹ã‚ã‚‹å‰ã«æº–å‚™ã™ã‚‹ã“ã¨

**ğŸ’¡ ç›®çš„**

QIIME2è§£æã‚’å§‹ã‚ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã¨èµ·å‹•æº–å‚™ã‚’æ•´ãˆã¾ã™ã€‚

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ãªå ´æ‰€ã«é…ç½®ã—ã€Ubuntuç’°å¢ƒã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

**ğŸ§¾ ç”¨æ„ã™ã‚‹ã‚‚ã®**

1.é…å¸ƒã•ã‚ŒãŸã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆä¾‹ï¼šFASTQ_2025_10_30ï¼‰

ã€€ä¸­ã«ã¯ã€Œï¼Š_R1_001.fastq.gzã€ã€Œï¼Š_R2_001.fastq.gzã€ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

2.Ubuntuï¼ˆWSL2ï¼‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹Windows PC

3.äº‹å‰ã«æ§‹ç¯‰æ¸ˆã¿ã®QIIME2ç’°å¢ƒï¼šq2-picrust2-amplicon-2024.5

---
**ğŸªŸ 1.Windowsã§ã®æº–å‚™**

1.ç ”ç©¶å®¤PCã‚’èµ·å‹•ã™ã‚‹ã€‚

2.é…å¸ƒã•ã‚ŒãŸã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã«ã‚³ãƒ”ãƒ¼ã—ã¦ãŠãã€‚

ã€€ï¼ˆUSBã‚„Google Driveã‹ã‚‰å—ã‘å–ã£ãŸå ´åˆã‚‚ã€**å¿…ãšã€Œãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ä¸Šã€**ã€€ã«ç½®ãï¼‰
 
```
ä¾‹ï¼š
C:\Users\ãƒ¦ãƒ¼ã‚¶ãƒ¼å\Desktop\FASTQ_2025_10_30
ã€€â”œâ”€ Sample1_S1_L001_R1_001.fastq.gz
ã€€â”œâ”€ Sample1_S1_L001_R2_001.fastq.gz
ã€€â””â”€ â€¦
```
---
**ğŸ§© 2.Ubuntuã®èµ·å‹•**

1.ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ä¸Šã®ã€ŒUbuntuã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦é–‹ãã€‚

2.UbuntuãŒé–‹ã„ãŸã‚‰ã€è§£æç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹ã€‚

ã€ŒğŸ“‹ã€
```bash
conda activate q2-picrust2-amplicon-2024.5
```
3.ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€ä½œæ¥­å ´æ‰€ã‚’ç¢ºèªã™ã‚‹ã€‚

ã€ŒğŸ“‹ã€
```bash
cd ~
ls
```

**ã€Œqiimeã€ãƒ•ã‚©ãƒ«ãƒ€ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OKã€‚**

---
**ğŸ§© 3.ç­ãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ**

è§£æã‚’å§‹ã‚ã‚‹å‰ã«ã€~/qiime/template ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦**è‡ªåˆ†ã®ç­å**ã«å¤‰æ›´ã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã®å®Ÿè¡Œã¾ãŸã¯ã€~/qiimeãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ãã€/template ã‚’ã‚³ãƒ”ãƒšã—ã¦ã‚‚è¡Œãˆã¾ã™ã€‚


ã€ŒğŸ“‹ã€**â–¡ã‚’æ¶ˆã—ã¦è‡ªåˆ†ã®ç­åã«å¤‰æ›´**
```bash
cd ~/qiime
cp -r templateã€€â–¡â–¡â–¡
```

ä½œæˆå¾Œã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆä¾‹ï¼š
```
~/qiime/
â”œâ”€â”€ template/          # é››å½¢ï¼ˆè§¦ã‚‰ãªã„ï¼‰
â”œâ”€â”€ ishikawa/          # è‡ªåˆ†ã®ç­ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆã“ã“ã§è§£æã‚’å®Ÿè¡Œï¼‰
â”‚   â”œâ”€â”€ raw_data/
â”‚   â”œâ”€â”€ manifest/
â”‚   â”œâ”€â”€ metadata/
â”‚   â”œâ”€â”€ results_qiime/
â”‚   â””â”€â”€ results_picrust2/
```


> âœ… templateã¯å…±é€šæ§‹æˆã‚’ä¿ã¤ãŸã‚å‰Šé™¤ã—ãªã„ã§ãã ã•ã„ã€‚  
> âœ… å„ç­ã¯è‡ªåˆ†ã®ãƒ•ã‚©ãƒ«ãƒ€ã§ã®ã¿è§£æã‚’è¡Œã„ã¾ã™ã€‚  

---

**ğŸ§© 4.è§£æã‚’è¡Œã†ç­ã®è¨­å®š**

ã€ŒğŸ“‹ã€**â–¡ã‚’æ¶ˆã—ã¦è‡ªåˆ†ã®ç­åã«å¤‰æ›´**
```bash
export master="/home/seeei/qiime/ãƒ•ã‚©ãƒ«ãƒ€å"
```

ã€ŒğŸ“‹ã€
```bash
cd $master
```

ã“ã‚Œä»¥é™ã€ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ã§ã€€**$master**ã€€ãŒè‡ªå‹•çš„ã«ç­åã«ç½®ãæ›ã‚ã‚Šã¾ã™ã€‚  

---

**ğŸ“ 5.ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã®ç¢ºèª**

è§£æã‚’å§‹ã‚ã‚‹å‰ã«ã€ç­ãƒ•ã‚©ãƒ«ãƒ€ãŒæ­£ã—ãä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚

ã€ŒğŸ“‹ã€
```bash
ls
```

å‡ºåŠ›ãŒä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚Œã°å•é¡Œãªã„ã§ã™ã€‚
```bash
manifest  metadata  raw_data  results_picrust2  results_qiime
```

---

## ğŸ§¬ STEP 2ï½œFASTQãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®
å—ã‘å–ã£ãŸã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿

ä¾‹ï¼š39320-04_S1_L001_R1_001.fastq.gz,

  39320-04_S1_L001_R2_001.fastq.gz
    
  ã‚’ å…ˆã»ã©ä½œæˆã—ãŸ$master/raw_data/ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

ä¾‹ï¼š
```bash
~/qiime/ishikawa/raw_data/39320-04_S1_L001_R1_001.fastq.gz
~/qiime/ishikawa/raw_data/39320-04_S1_L001_R2_001.fastq.gz
```

---

## ğŸ§¾ STEP 3ï½œmanifestãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½œæˆ

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€FASTQãƒ•ã‚¡ã‚¤ãƒ«ã®å¯¾å¿œè¡¨ï¼ˆmanifestãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚

ã€ŒğŸ“‹ã€
```bash
bash ~/qiime/tools/make_manifest.sh
```
è‡ªå‹•ã§ $master/manifest/manifest.csv ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚  
ç”Ÿæˆå¾Œã€manifest.csvã‚’excelã§é–‹ã

**ä¸€åˆ—ç›®ã®ã€Œsample-idã€ åˆ—ã‚’è‡ªåˆ†ã®ã‚µãƒ³ãƒ—ãƒ«åï¼ˆä¾‹ï¼šNC1ï½5, HF1ï½5, RBR1ï½5ï¼‰ã«ç·¨é›†ã—ã¾ã™ã€‚**

ã€Œsample-idã€åˆ—ã¯ forward ã¨ reverse ãŒãƒšã‚¢ã«ãªã‚‹ãŸã‚

**åŒã˜ã‚µãƒ³ãƒ—ãƒ«åã‚’2è¡Œç¶šã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚**

**ä¾‹ï¼ˆExcelè¡¨ç¤ºï¼‰**
| sample-id | absolute-filepath                                         | direction |
| -----------| --------------------------------------------------------- | --------- |
| ä¾‹ï¼šNC1    | /home/ishikawa/qiime/raw_data/NC1_S1_L001_R1_001.fastq.gz | forward   |
| ä¾‹ï¼šNC1    | /home/ishikawa/qiime/raw_data/NC1_S1_L001_R2_001.fastq.gz | reverse   |
| ä¾‹ï¼šHF1    | /home/ishikawa/qiime/raw_data/HF1_S2_L001_R1_001.fastq.gz | forward   |
| ä¾‹ï¼šHF1    | /home/ishikawa/qiime/raw_data/HF1_S2_L001_R2_001.fastq.gz | reverse   |

æ¬¡ã«ã€å¾Œå‡¦ç†ã¨ã—ã¦ä»¥ä¸‹ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã”èªè­˜ã‚’é˜²ãã¾ã™ã€‚

ã€ŒğŸ“‹ã€
```bash
sed -i 's/\r$//' $master/manifest/manifest.csv
sed -i '1s/^\xEF\xBB\xBF//' $master/manifest/manifest.csv
```

---

## ğŸ§¬ STEP 4ï½œmetadataã®ä½œæˆ

ã€ŒğŸ“‹ã€
```bash
bash ~/qiime/tools/make_metadata.sh
```
è‡ªå‹•ã§ $master/metadata/metadata.tsvã€€ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚ 
ç”Ÿæˆå¾Œã€metadata.tsvã‚’excelã§é–‹ãã€
**group åˆ—ï¼ˆä¾‹ï¼šNC, HF, BR, RBRï¼‰ã¯å„ç­ã§æ‰‹å‹•å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚**

**ä¾‹ï¼ˆExcelè¡¨ç¤ºï¼‰**
| sample-id | group       |
| --------- | ----------- |
| #q2:types | categorical |
| NC1       | NC          |
| NC2       | NC          |
| HF1       | HF          |
| HF2       | HF          |


æ¬¡ã«ã€å¾Œå‡¦ç†ã¨ã—ã¦ä»¥ä¸‹ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã”èªè­˜ã‚’é˜²ãã¾ã™ã€‚

ã€ŒğŸ“‹ã€
```bash
sed -i 's/\r$//' "$master/metadata/metadata.tsv"
sed -i '1s/^\xEF\xBB\xBF//' "$master/metadata/metadata.tsv"
```

---

## ğŸ§« STEP 5ï½œFASTQ â†’ QIIME2ï¼ˆ.qzaï¼‰ã¸ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

ã€ŒğŸ“‹ã€
```bash
qiime tools import \
  --type 'SampleData[PairedEndSequencesWithQuality]' \
  --input-path $master/manifest/manifest.csv \
  --output-path $master/results_qiime/demux.qza \
  --input-format PairedEndFastqManifestPhred33
```
âœ… æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
Imported ... as PairedEndFastqManifestPhred33 to .../demux.qza
ãŒå‡ºã‚Œã°OKã€‚
ç”Ÿæˆå¾Œã€results_qiimeã«**qzaãƒ•ã‚¡ã‚¤ãƒ«**ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---

## ğŸ“Š STEP 6ï½œã‚·ãƒ¼ã‚±ãƒ³ã‚¹å“è³ªç¢ºèªï¼ˆPhredã‚¹ã‚³ã‚¢ï¼‰

ã€ŒğŸ“‹ã€
```bash
qiime demux summarize \
  --i-data $master/results_qiime/demux.qza \
  --o-visualization $master/results_qiime/demux.qzv
```
**ç”Ÿæˆã•ã‚ŒãŸ qzvãƒ•ã‚¡ã‚¤ãƒ«ã‚’ ğŸ‘‰ https://view.qiime2.org ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ç¢ºèªã—ã¾ã™ã€‚**

ç”Ÿæˆã•ã‚ŒãŸã‚°ãƒ©ãƒ•ã‚’ç¢ºèªã—ã€**ãƒˆãƒªãƒŸãƒ³ã‚°é•·**ã‚’æ±ºå®šã—ã¾ã™ã€‚

**ğŸ’¡ ãªãœã“ã®ä½œæ¥­ãŒå¿…è¦ãªã®ã‹ï¼Ÿ**

ã‚·ãƒ¼ã‚±ãƒ³ã‚µãƒ¼ã§å¾—ã‚‰ã‚ŒãŸãƒªãƒ¼ãƒ‰ï¼ˆé…åˆ—ï¼‰ã¯ã€æœ«ç«¯ã«è¿‘ã¥ãã»ã©**ã‚¨ãƒ©ãƒ¼ãŒå¢—ãˆã‚‹**ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®ã‚¨ãƒ©ãƒ¼éƒ¨åˆ†ã‚’æ®‹ã—ãŸã¾ã¾è§£æã‚’é€²ã‚ã‚‹ã¨ã€

ï¼DADA2 ãŒèª¤ã£ã¦ã€Œãƒã‚¤ã‚ºã‚’æœ¬ç‰©ã®é…åˆ—ã€ã¨åˆ¤æ–­ã—ãŸã‚Šã€

ï¼ãƒªãƒ¼ãƒ‰åŒå£«ã®é‡ãªã‚Šï¼ˆãƒãƒ¼ã‚¸ï¼‰ãŒå¤±æ•—ã—ãŸã‚Šã€

ï¼æœ€çµ‚çš„ãªASVæ•°ã‚„åˆ†é¡çµæœãŒä¸æ­£ç¢ºã«ãªã‚‹
ãªã©ã®å•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ã€‚

ãã“ã§ã€ã€€**å“è³ªãŒæ€¥æ¿€ã«ä½ä¸‹ã™ã‚‹éƒ¨åˆ†ã‚’åˆ‡ã‚Šè½ã¨ã™ï¼ˆãƒˆãƒªãƒŸãƒ³ã‚°ï¼‰**ã€€ã“ã¨ã§ã€
ãƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼æ€§ã‚’ä¿ã¡ã€ä»¥é™ã®è§£æï¼ˆDADA2ãƒ»åˆ†é¡ãƒ»å¤šæ§˜æ€§è§£æãªã©ï¼‰ã‚’æ­£ç¢ºã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

**ğŸ‘€ Phredã‚¹ã‚³ã‚¢ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹**

ã‚°ãƒ©ãƒ•ã®ç¸¦è»¸ã¯ã€ŒPhredã‚¹ã‚³ã‚¢ï¼ˆå“è³ªï¼‰ã€ã€æ¨ªè»¸ã¯ã€Œå¡©åŸºä½ç½®ï¼ˆãƒªãƒ¼ãƒ‰ã®é•·ã•ï¼‰ã€ã§ã™ã€‚
ã‚¹ã‚³ã‚¢ãŒé«˜ã„ã»ã©ã‚¨ãƒ©ãƒ¼ãŒå°‘ãªãã€ä¿¡é ¼æ€§ãŒé«˜ã„é…åˆ—ã§ã™ã€‚
| Phredå€¤ | æ„å‘³         | ã‚¨ãƒ©ãƒ¼ç‡ã®ç›®å®‰  |
| ------ | ---------- | -------- |
| â‰¥30    | éå¸¸ã«é«˜å“è³ª     | 0.1ï¼…æœªæº€   |
| 25ï½30  | è¨±å®¹ç¯„å›²å†…      | 0.3ï½1ï¼…ç¨‹åº¦ |
| â‰¤20    | è¦æ³¨æ„ï¼ˆãƒã‚¤ã‚ºå¤šã„ï¼‰ | 1ï¼…ä»¥ä¸Š     |

ã“ã®ã¨ã

**é»’éƒ¨åˆ†ï¼šå“è³ªãŒé«˜ãå®‰å®šã—ãŸé ˜åŸŸï¼ˆã‚¹ã‚³ã‚¢ãŒé«˜ã„ï¼‰**

**ç°è‰²ã®éƒ¨åˆ†ï¼šå“è³ªãŒä½ä¸‹ã—ã¦ã„ã‚‹é ˜åŸŸï¼ˆã‚¹ã‚³ã‚¢ãŒä½ã„ï¼‰**

ã¨ãªã‚Šã¾ã™ã€‚

ã‚°ãƒ©ãƒ•ã®é»’éƒ¨åˆ†ã‚’å‚è€ƒã«ã€å„ãƒˆãƒªãƒŸãƒ³ã‚°é•·ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚

**âœ‚ï¸ ãƒˆãƒªãƒŸãƒ³ã‚°é•·ã®æ±ºã‚æ–¹ï¼ˆå®Ÿè·µã‚¹ãƒ†ãƒƒãƒ—ï¼‰**

**1.Forwardï¼ˆR1ï¼‰ãƒ»Reverseï¼ˆR2ï¼‰ã®ä¸¡æ–¹ã‚’ç¢ºèª**

å„ã‚µãƒ³ãƒ—ãƒ«ã®ã‚°ãƒ©ãƒ•ã‚’é–‹ãã€å³ç«¯ã«å‘ã‹ã£ã¦ã‚¹ã‚³ã‚¢ãŒæ€¥æ¿€ã«ä¸‹ãŒã‚‹ç®‡æ‰€ã‚’æ¢ã—ã¾ã™ã€‚

**2.å“è³ªä½ä¸‹ãŒå§‹ã¾ã‚‹å°‘ã—æ‰‹å‰ã‚’ã‚«ãƒƒãƒˆä½ç½®ã«è¨­å®š**

ãŸã¨ãˆã°ã€R1ã®ã‚¹ã‚³ã‚¢ãŒ270bpä»˜è¿‘ã§ä¸‹ãŒã‚Šå§‹ã‚ãŸã‚‰ã€

--p-trunc-len-f **270**

ã¨ã—ã¾ã™ã€‚

åŒæ§˜ã«ã€R2ãŒ220bpã‚ãŸã‚Šã§ä¸‹ãŒã‚‹ãªã‚‰ã€

--p-trunc-len-r **220**

ã¨ã—ã¾ã™ã€‚

**3.çŸ­ã™ãã‚‹ãƒˆãƒªãƒŸãƒ³ã‚°ã¯é¿ã‘ã‚‹**

Forwardã¨Reverseã®é‡ãªã‚ŠãŒ150bpä»¥ä¸Šæ®‹ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
ãã†ã—ãªã„ã¨ã€ãƒãƒ¼ã‚¸ï¼ˆé‡ã­åˆã‚ã›ï¼‰ãŒã§ããšã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

ã“ã®ãƒˆãƒªãƒŸãƒ³ã‚°é•·ã‚’ã‚‚ã¨ã«æ¬¡ã®STEP7ã§ã®æ•°å­—ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„

---

## ğŸ§® STEP 7ï½œDADA2ã«ã‚ˆã‚‹ãƒã‚¤ã‚ºé™¤å»ã¨ASVåŒ–

ã€ŒğŸ“‹ã€**â–¡â–¡â–¡ã‚’æ±ºå®šã—ãŸãƒˆãƒªãƒŸãƒ³ã‚°é•·ã«æ±ºå®šã—ã¦ãã ã•ã„ã€‚**
```bash
qiime dada2 denoise-paired \
  --i-demultiplexed-seqs "$master/results_qiime/demux.qza" \
  --p-trunc-len-f â–¡â–¡â–¡ \
  --p-trunc-len-r â–¡â–¡â–¡ \
  --o-table "$master/results_qiime/table.qza" \
  --o-representative-sequences "$master/results_qiime/rep-seqs.qza" \
  --o-denoising-stats "$master/results_qiime/denoising-stats.qza"
```
ã“ã®ä½œæ¥­ã¯é•·ãã¦ç´„ï¼‘æ—¥ã¨ã€ã¨ã¦ã‚‚æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚

å¯èƒ½ãªã‚‰ã€

---

## ğŸ§¬ STEP 8ï½œåˆ†é¡ï¼ˆSILVAåˆ†é¡å™¨ï¼‰
å…±é€šã§æ§‹ç¯‰æ¸ˆã¿ã®åˆ†é¡å™¨ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚  

ã€ŒğŸ“‹ã€
```bash
qiime feature-classifier classify-sklearn \
  --i-classifier ~/qiime/databases/silva-138.1-nr99-v4-classifier.qza \
  --i-reads $master/results_qiime/rep-seqs.qza \
  --o-classification $master/results_qiime/taxonomy.qza
```

---

## ğŸ§© STEP 9ï½œåˆ†é¡çµæœã®å¯è¦–åŒ–

ã€ŒğŸ“‹ã€
```bash
qiime metadata tabulate \
  --m-input-file $master/results_qiime/taxonomy.qza \
  --o-visualization $master/results_qiime/taxonomy.qzv
```

---

## ğŸ§  STEP 10ï½œå¤šæ§˜æ€§è§£æ

### Î±å¤šæ§˜æ€§

ã€ŒğŸ“‹ã€
```bash
qiime diversity alpha \
  --i-table $master/results_qiime/table.qza \
  --p-metric shannon \
  --o-alpha-diversity $master/results_qiime/alpha_shannon.qza
```

### Î²å¤šæ§˜æ€§

ã€ŒğŸ“‹ã€
```bash
qiime diversity beta \
  --i-table $master/results_qiime/table.qza \
  --p-metric braycurtis \
  --o-distance-matrix $master/results_qiime/braycurtis.qza
```

---

## ğŸ§¬ STEP 11ï½œPICRUSt2è§£æ

ã€ŒğŸ“‹ã€
```bash
qiime picrust2 full-pipeline \
  --i-table $master/results_qiime/table.qza \
  --i-seq $master/results_qiime/rep-seqs.qza \
  --output-dir $master/results_picrust2/ \
  --p-threads 6 \
  --p-hsp-method pic \
  --p-max-nsti 2
```

---

## ğŸŒˆ STEP 12ï½œå¯è¦–åŒ–
`results_qiime/` ãŠã‚ˆã³ `results_picrust2/` å†…ã® `.qzv` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’  
ğŸ‘‰ https://view.qiime2.org ã«ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é–‹ãã¾ã™ã€‚

---

## ğŸ“˜ å‚è€ƒæƒ…å ±
- QIIME2 Documentationï¼ˆ2024.5ï¼‰: https://docs.qiime2.org/2024.5/
- SILVA Database (v138.1): https://www.arb-silva.de/
- ä½¿ç”¨ç’°å¢ƒï¼šUbuntu 24.04ï¼ˆWSL2ï¼‰, q2-picrust2-amplicon-2024.5
- ä½œæˆï¼šSEROL1ï¼ˆQIIME2å…±é€šè§£æãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰
